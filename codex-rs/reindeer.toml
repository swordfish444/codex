##
## Reindeer config for codex-rs (Cargo workspace) + Buck2.
##
## This file is checked in, but generated Buck artifacts (BUCK files and
## vendored crates) are intentionally gitignored for now.
##

# Focus buckification on the main CLI to avoid pulling in platform-specific
# workspace members that can create duplicate "public alias" names.
manifest_path = "cli/Cargo.toml"

# Place generated output under codex-rs/third-party/.
third_party_dir = "third-party"

# Use vendored crates (no crates.io downloads during `buck2 build`).
vendor = true

# Provide common Cargo env vars for crates/build scripts that use `env!()`.
cargo_env = [
    "CARGO_CRATE_NAME",
    "CARGO_MANIFEST_DIR",
    "CARGO_PKG_AUTHORS",
    "CARGO_PKG_DESCRIPTION",
    "CARGO_PKG_NAME",
    "CARGO_PKG_REPOSITORY",
    "CARGO_PKG_VERSION",
    "CARGO_PKG_VERSION_MAJOR",
    "CARGO_PKG_VERSION_MINOR",
    "CARGO_PKG_VERSION_PATCH",
    "CARGO_PKG_VERSION_PRE",
]

[buck]
file_name = "BUCK"

# These resolve to macros defined in codex-rs/buck2/reindeer_macros.bzl.
alias = "codex_noop_alias"
alias_with_platforms = "codex_noop_alias"
rust_library = "codex_rust_library"
rust_binary = "codex_rust_binary"
buildscript_genrule = "codex_buildscript_run"

buckfile_imports = """
load("//codex-rs/buck2:reindeer_macros.bzl", "codex_buildscript_run", "codex_noop_alias", "codex_rust_binary", "codex_rust_library")
"""

generated_file_header = """
##
## @generated by reindeer
## Do not edit by hand.
##
## To regenerate:
##   (cd codex-rs && reindeer vendor && reindeer buckify)
##
"""

